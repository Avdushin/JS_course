# Node.js


Node.js является платформой для разработки серверных приложений и веб-сервисов на JavaScript.\

Она позволяет разрабатывать быстрые и масштабируемые приложения, которые могут обрабатывать большое количество запросов одновременно.

Node.js – это платформа для выполнения JavaScript на стороне сервера. 


### Создание первого приложения на node.js

1. Установка Node.js

Для начала создания проекта на Node.js необходимо установить сам Node.js на свой компьютер. \
Это можно сделать с помощью официального сайта Node.js по ссылке https://nodejs.org/ru

2. Создание нового проекта

После установки Node.js на компьютер необходимо создать новую папку для проекта.\
В этой папке мы будем хранить все файлы проекта. \
перейдите в папку для проекта

Создайте новый файл package.json, который будет содержать информацию о проекте и его зависимостях:

```
npm init
```


Следуйте инструкциям в терминале и введите информацию о вашем проекте, такую как имя, версию, описание и прочие.

3. Установка зависимостей проекта

Node.js позволяет использовать множество готовых модулей, которые можно установить с помощью менеджера пакетов npm. \
Обычно с node.js используют фреймворк Express для создания веб-приложений.\
Нужно установить его с помощью команды:


```
npm install express --save
```

В этом примере мы устанавливаем модуль Express и добавляем его в список зависимостей проекта в файле package.json.\
Флаг --save указывает на то, что зависимость должна быть сохранена в файле package.json.

4. Создание файла приложения

Создайте новый файл app.js в папке проекта.\
В этом файле мы будем создавать наше приложение на Node.js. \
Создадим простой веб-сервер, который будет отдавать "Hello, World!" на любой запрос:


```js
const express = require('express');

const app = express();

app.get('/', (req, res) => {
  res.send('Hello, World!');
});

app.listen(3000, () => {
  console.log('Server listening on port 3000');
});
```

Мы используем модуль Express для создания веб-приложения. \
Создаем новый экземпляр приложения и добавляем маршрут для обработки GET-запросов на URL-адрес /, который отправляет ответ "Hello, World!".\
Затем мы запускаем сервер на порту 3000 с помощью метода listen.

5. Запуск приложения

Чтобы запустить приложение, нужно выполнить следующую команду в терминале:

```
node app
```

Чтобы запустить этот файл через Node.js, нужно сохранить его с расширением .js и запустить в терминале командой:


```
node имя_файла.js
```

### Одним из ключевых элементов Node.js являются таймеры и модули.

## Таймеры в Node.js
Таймеры в Node.js предназначены для запуска функций через определенный промежуток времени.\
В Node.js есть три типа таймеров: setTimeout, setInterval и setImmediate.

### setTimeout
Функция setTimeout позволяет вызывать функцию один раз через определенное время.\
Она принимает два параметра: функцию, которую нужно вызвать, и время в миллисекундах, через которое нужно вызвать функцию.

Вызовем функцию console.log через одну секунду.
```js
setTimeout(function() {
  console.log('Hello, World!');
}, 1000);

```

### setInterval
Функция setInterval позволяет вызывать функцию через определенный интервал времени. \
Она принимает два параметра: функцию, которую нужно вызвать, и время в миллисекундах между вызовами функции.

Вызовем функцию console.log каждую секунду.


```js
setInterval(function() {
  console.log('Hello, World!');
}, 1000);
```

### setImmediate

Функция setImmediate позволяет вызывать функцию в следующем цикле событий. \
Она принимает один параметр: функцию, которую нужно вызвать.

Вызовем функцию console.log в следующем цикле событий.

```js
setImmediate(function() {
  console.log('Hello, World!');
});

```


## Модули в Node.js
Модули в Node.js предназначены для организации кода и обеспечения его переиспользования.\
Node.js поддерживает CommonJS-модули, которые имеют два типа экспорта: экспорт объекта и экспорт функции.

### Экспорт объекта
Для экспорта объекта используется следующий синтаксис:

```js
// math.js
module.exports = {
  add: function(a, b) {
    return a + b;
  },
  subtract: function(a, b) {
    return a - b;
  }
};

```

Этот модуль экспортирует объект с двумя функциями: add и subtract.

Чтобы использовать этот модуль в другом файле, нужно импортировать его с помощью функции require:


```js
// app.js
const math = require('./math');

console.log(math.add(2, 3)); // 5
console.log(math.subtract(5, 2)); // 3
```

Мы импортировали модуль math из файла math.js и использовали его функции add и subtract в файле app.js.

## Экспорт функции
Для экспорта функции используется следующий синтаксис:

```js
// greet.js
module.exports = function(name) {
  console.log('Hello, ' + name + '!');
};
```

Этот модуль экспортирует функцию, которая приветствует пользователя по имени.

Чтобы использовать этот модуль в другом файле, можно импортировать его и вызвать функцию:

```js
// app.js
const greet = require('./greet');

greet('World'); // Hello, World!
```

Мы импортировали модуль greet из файла greet.js и вызвали его функцию, передав ей параметр 'World'.


# Работа с файловой системой в node.js

За работу с файловой системой в NodeJS отвечает встроенный модуль fs, который необходимо импортировать:

```js
// Подключаем модуль fs
import fs from 'fs';

// Синхронное чтение файла
try {
  // Читаем содержимое файла
  const text = fs.readFileSync('readme.txt', 'utf8');
  console.log(text);
} catch (err) {
  // Обрабатываем ошибку
  console.error('Ошибка при чтении файла:', err);
}

// Синхронная запись файла
try {
  // Записываем текст в файл
  fs.writeFileSync('example.txt', 'Hello, World!');
  console.log('Файл успешно записан');
} catch (err) {
  // Обрабатываем ошибку
  console.error('Ошибка при записи файла:', err);
}

// Синхронное чтение и запись файла
try {
  // Читаем содержимое файла
  let text = fs.readFileSync('readme.txt', 'utf8');

  // Добавляем в конец файла символ !
  text += '!';

  // Записываем измененный текст обратно в файл
  fs.writeFileSync('readme.txt', text);
  console.log('Файл успешно записан');
} catch (err) {
  // Обрабатываем ошибку
  console.error('Ошибка при работе с файлом:', err);
}

```

# Асинхронное чтение и запись файлов в NodeJS

Рассмотрим теперь асинхронную работу с файлами в NodeJS.\
Она сложнее, но более эффективна, так как не блокирует скрипт.\
Для этого в модуле fs есть соответствующие методы: readFile и writeFile.

# Асинхронное чтение файла
Для асинхронного чтения файла используется метод readFile.\
Первым параметром он принимает имя файла или путь к файлу, а вторым - кодировку файла.\
Кроме того, метод принимает еще один параметр - функцию обратного вызова, которая будет вызвана после завершения чтения файла. \
В эту функцию будут переданы два параметра: ошибка (если она возникла) и данные из файла.

Пусть в папке с нашим скриптом располагается файл readme.txt.\
Давайте прочитаем его асинхронно и выведем на экран:

```js
fs.readFile('readme.txt', 'utf8', (err, data) => {
if (err) {
console.error(err);
return;
}
console.log(data);
});
```
# Асинхронная запись файла
Для асинхронной записи в файл используется функция writeFile.\
Первым параметром она принимает имя файла или путь к нему, а вторым - текст, который мы хотим записать в этот файл. \
Кроме того, функция принимает еще один параметр - функцию обратного вызова, которая будет вызвана после завершения записи файла.\
В эту функцию будет передана ошибка (если она возникла).

```js
fs.writeFile('message.txt', 'Hello Node.js', (err) => {
if (err) {
console.error(err);
return;
}
console.log('Файл записан');
});
```

# Асинхронные чтение и запись файла
Можно читать данные из файла, совершать над ними какую-нибудь операцию, а затем записывать обратно асинхронно.

Для примера давайте прочитаем текст из файла readme.txt, добавим ему в конец знак ! и запишем измененный текст обратно в файл:

```js
fs.readFile('readme.txt', 'utf8', (err, data) => {
if (err) {
console.error(err);
return;
}
fs.writeFile('readme.txt', data + '!', (err) => {
if (err) {
console.error(err);
return;
}
console.log('Файл изменен');
});
});

```

# Исключительные ситуации

При работе с файловой системой могут возникать различные исключительные ситуации.\
Например, файл может отсутствовать, может отказать жесткий диск, диск может быть переполнен, диск может сломаться и не отвечать, у вас может не быть прав для записи в определенную папку и так далее.

Поэтому любую работу с файловой системой необходимо оборачивать в try-catch:

```js
try {
let text = fs.readFileSync('readme.txt', 'utf8');
console.log(text);
} catch (err) {
console.log('при чтении файла возникла ошибка', err);
}
```

________________________
________________________
________________________
# Домашнее задание:

### Задача 1

Напишите приложение на Node.js, которое будет принимать GET-запросы на URL-адрес /hello и возвращать текст "Hello, World!" в качестве ответа.


### Задача 2

Напишите приложение на Node.js, которое будет принимать POST-запросы на URL-адрес /login и проверять, правильно ли пользователь ввел логин и пароль. \
Если логин и пароль верны, то приложение должно возвращать ответ с кодом 200 и текстом "Success", в противном случае – ответ с кодом 401 и текстом "Unauthorized".


### Задача 3

Напишите приложение на Node.js, которое будет принимать GET-запросы на URL-адрес /random и возвращать случайное число от 1 до 100 в качестве ответа.


### Задача 4

Напишите приложение на Node.js, которое будет копировать содержимое одного файла в другой файл.


### Задача 5

Напишите приложение на Node.js, которое будет переименовывать файлы в указанной директории.\
Новое имя каждого файла должно быть задано в формате "номер_файла.расширение", где номер файла - порядковый номер файла в директории.

